extends layout

block content
  h1 Users
  div(id='userTable', width='100%' height='500px')

  script(type="text/javascript").
    function createRoleEditor(container, options)
    {
      var dsRoles = new kendo.data.DataSource({
      transport: {
        read: {
          url: "/api/roles",
          dataType: "json"
          }
        },
        schema: {
         data: "roles"
        }
      });

      var input = $('<input/>');
      input.name = options.field;
      input.appendTo(container);
      input.kendoAutoComplete({
        dataSource: dsRoles,
        dataTextField: "name",
        separator: ", "
        });
    }

    $(function() {
    var ds = new kendo.data.DataSource({
      transport: {
        read: {
          url: "/api/users",
          dataType: "json"
          }
        },
        schema: {
         data: "users"
        }
      });

    $("#userTable").kendoGrid({
      dataSource: ds,
      columns: [{
        field: "name",
        title: "Name",
        editable: 'inline'
      }, {
        field: "id",
        title: "RFID Id",
        editable: 'inline'
      }, {
        field: "roles",
        title: "Roles",
        editable: 'inline',
        editor: createRoleEditor
      }, {
        title: "Actions",
        command: [ {name:"save", text:"Save"}, "destroy"]
      }],
      editable: true,
      sortable: true
      });
    });
